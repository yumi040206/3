<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>China Influencer City Map</title>

<!-- 本地加载 ECharts -->
<script src="./assets/echarts.min.js"></script>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #111;
  color: #fff;
  font-family: Arial, sans-serif;
}
#main {
  width: 100%;
  height: 100vh;
}
</style>
</head>

<body>
<div id="main"></div>

<script>
const chart = echarts.init(document.getElementById('main'));

// 本地 GeoJSON
const CHINA_GEOJSON = "./assets/100000_full.json";

// 示例城市数据（可替换成你自己的）
const cityData = [
  {name: "北京", value: 95},
  {name: "上海", value: 98},
  {name: "广州", value: 88},
  {name: "深圳", value: 92},
  {name: "杭州", value: 85},
  {name: "成都", value: 80},
  {name: "重庆", value: 78},
  {name: "武汉", value: 75}
];

async function initMap() {
  try {
    const response = await fetch(CHINA_GEOJSON);
    const geoJson = await response.json();

    echarts.registerMap('china', geoJson);

    const option = {
      tooltip: {
        trigger: 'item'
      },
      visualMap: {
        min: 0,
        max: 100,
        left: 'left',
        top: 'bottom',
        text: ['High','Low'],
        calculable: true,
        inRange: {
          color: ['#2c7bb6', '#ffffbf', '#d7191c']
        }
      },
      series: [
        {
          name: 'Influencer Index',
          type: 'map',
          map: 'china',
          roam: true,
          emphasis: {
            label: {
              show: true
            }
          },
          data: cityData
        }
      ]
    };

    chart.setOption(option);

  } catch (error) {
    document.body.innerHTML = "<h2 style='color:red;text-align:center;margin-top:40vh;'>地图加载失败，请确认 assets 文件夹存在</h2>";
    console.error(error);
  }
}

initMap();

window.addEventListener('resize', function () {
  chart.resize();
});
</script>

</body>
</html>
